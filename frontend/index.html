<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥—Å—á—ë—Ç–∞ –ª—é–¥–µ–π</title>
<link rel="stylesheet" href="style.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script defer src="script.js"></script>
</head>
<body>

<!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
<div class="screen" id="mainScreen">
    <h2>–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</h2>

    <button class="menu-btn" onclick="showScreen('statisticsScreen')">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
</div>


<!-- üü• –≠–∫—Ä–∞–Ω —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
<div class="screen" id="statisticsScreen" style="display:none;">
    <div class="screen-header">
        <button class="back-btn" onclick="showScreen('mainScreen')">‚Üê –ù–∞–∑–∞–¥</button>
        <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Å–µ—â–µ–Ω–∏–π</h2>
        <div style="width:40px"></div>
    </div>

    <div class="status">
        <span id="statusDot" class="dot"></span>
        <span id="statusText">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</span>
    </div>

    <!-- –í–∏–¥–µ–æ -->
    <img id="videoStream" src="/video" style="width:100%;max-width:500px;border-radius:10px;">

    <h3 style="margin-top:15px;">–¢–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ:</h3>
    <p>–õ—é–¥–µ–π —Å–µ–π—á–∞—Å: <b id="currentCount">-</b></p>
    <p>–û–±–Ω–æ–≤–ª–µ–Ω–æ: <b id="lastUpdate">--:--:--</b></p>

    <h3>–ì—Ä–∞—Ñ–∏–∫</h3>
    <div style="height:350px;margin-bottom:20px;">
        <canvas id="statisticsChart"></canvas>
    </div>

    <button id="exportBtn" class="menu-btn">üìÑ –≠–∫—Å–ø–æ—Ä—Ç CSV/JSON</button>

    <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 –∑–∞–ø–∏—Å–µ–π</h3>
    <table border="1" width="100%">
        <thead>
            <tr><th>–í—Ä–µ–º—è</th><th>–õ—é–¥–µ–π</th></tr>
        </thead>
        <tbody id="statsTableBody"></tbody>
    </table>
</div>


<script>
function showScreen(name) {
    document.querySelectorAll('.screen').forEach(s => s.style.display = 'none');
    document.getElementById(name).style.display = 'block';
}
</script>

<style>
body { font-family: sans-serif; padding: 20px; background:#f9f9f9; }
.screen { max-width:600px;margin:auto; }
.menu-btn { width:100%;padding:12px;margin:5px 0;font-size:18px; }
.back-btn { padding:8px 12px; }
.status { margin:10px 0;font-size:16px;}
.dot {width:12px;height:12px;background:red;border-radius:50%;display:inline-block;margin-right:8px;}
.dot.active{background:green}
</style>

</body>
</html>
